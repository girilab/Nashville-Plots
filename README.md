# nashvillePlot

nashvillePlot is a graphing package for R to draw two-sided Manhattan plots on the same axes. 

## Prerequisites

To run nashvillePlot you need [R (>= 2.10)](https://cran.r-project.org/), with the following packages:
*  RColorBrewer (>= 1.1.2)
*  ggplot2 (>= 3.3.5)
*  ggrepel (>= 0.9.1)

## Installation
To install a package in R first install the devtools package
```r
install.packages("devtools")
```

Next install this package from github
```r
library(devtools)
install_github("girilab/Nashville-Plots")
```

## GWAS Input data
GWAS results should be formatted as obtained from `plink --assoc`. 
```
SNP CHR BP P
5:85928892 5 85928892 0.4193
14:36082010 14 36082010 0.6898
```

## MetaXcan Input data
MetaXcan results should be in a single folder with one or more files in the format of SPredixcan output which is a CSV like this:
```
gene,gene_name,zscore,effect_size,pvalue,var_g,pred_perf_r2,pred_perf_pval,pred_perf_qval,n_snps_used,n_snps_in_cov,n_snps_in_model
ENSG00000181195,PENK,-3.86051894654,-0.631240441339,0.000113146466554,0.020377756347,0.0103772657285,0.0791381742791,0.0340770623701,22,22,22
```
## Configuratin file input
The config file must be a tab-separated-values file with 3 columns: file name, label, and color. The data from the file will be labeled and colored appropriately when graphed.
```
AdiposeSubcutaneous.csv		AdiposeSubcutaneous	blue
CellsTransformedFibroblasts.csv	TransformedFibroblasts	green
```
## Setup and Usage Example
In order to use nashvillePlots just load your data and then call nashville.plot() with it. data1  and data2 may each be from `read_metaXcan_folder()` or `read_gwas_file()`
```r
library(nashvillePlot)
config.obj <- read_config("config.txt")
meta <- read_metaXcan_folder(directory = "~/data/")
gwas <- read_gwas_file(file = "gwas.txt")
mygraph <- nashville.plot(data1 = meta, data2 = gwas, config = config.obj)
```

The example parameters to nashville.plot mean:

*   `data1`, `data2`: data to be plotted generated by read_metaXcan_folder or read_gwas_file. data2 is optional.
*   `config`: config object from read_config()

For further information on the usage of nashville.plot() type `??nashville.plot` 

